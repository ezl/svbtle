<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: code | ezl]]></title>
  <link href="http://www.ezliu.com//blog/categories/code/atom.xml" rel="self"/>
  <link href="http://www.ezliu.com//"/>
  <updated>2012-12-24T13:50:01-06:00</updated>
  <id>http://www.ezliu.com//</id>
  <author>
    <name><![CDATA[ezl]]></name>
    <email><![CDATA[ericzliu@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Moving to Jekyll]]></title>
    <link href="http://www.ezliu.com//blog/moving-to-jekyll/"/>
    <updated>2012-09-17T19:20:00-05:00</updated>
    <id>http://www.ezliu.com//blog/moving-to-jekyll</id>
    <content type="html"><![CDATA[<p>Yep, I just did it.  I:</p>

<ul>
<li>stole the theme from Svbtle (Hey I like it, and it looks awesome -- Thanks Dustin);</li>
<li>inverted the colors (not because I like it dark, but because I want my blog to look distinctive/memorable,</li>
<li>threw my chop on there (Found a scan of it and its as good a logo as any, also memorable)</li>
<li>imported from wordpress (still links to the original images, which will almost certainly break, and I don't care)</li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[This is Another post]]></title>
    <link href="http://www.ezliu.com//blog/this-is-another-post/"/>
    <updated>2012-09-14T05:50:00-05:00</updated>
    <id>http://www.ezliu.com//blog/this-is-another-post</id>
    <content type="html"><![CDATA[<p>This is the song la la alsdjflasd kjfalsdk jflaskd
sadfjlkadsfhlasd
asdhfkaljfhlaksdjfh
kajsdhfklasjdfhlasdkfh</p>

<p>======================</p>

<p>This is an example of a note</p>

<div class="note">

asdfa asd fashdkj fhasdkf ha

aslfkdjs hflaksd hfas
a hsjkldf ahsdl
 aklsjfhalksdjf halskdjfha lskdjfh asldkj fhasdkljf ahsdkl fahs

</div>


<p>once upon a time i went to work and in the morning i had to walk to the brown line stop and take the traion in to the loop then i exit at the van buren stop which is where my office is.</p>

<h2>Test header 2</h2>

<p>then I ate some cheese for breakfast because it is creamy and delicious. fatty.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[zombie ninjas Attack]]></title>
    <link href="http://www.ezliu.com//blog/zombie-ninjas-attack/"/>
    <updated>2012-09-14T05:47:00-05:00</updated>
    <id>http://www.ezliu.com//blog/zombie-ninjas-attack</id>
    <content type="html"><![CDATA[<p>Content please</p>

<p>la la la</p>

<h3>block quote example</h3>

<blockquote><p>hello this is a quote
lets see how far it lets this go doe a deer a female deer ray a drop of golden sun me a name i call myself far a long long way to run sew a needle pulling thread la a note to follow so tea a drink with jam and bread that will bring us back to do do do do
and a third line, for giggles</p></blockquote>

<h3>code example</h3>

<pre><code>def hello():
    print hello
</code></pre>

<p>``` ruby Discover if a number is prime http://www.noulakaz.net/weblog/2007/03/18/a-regular-expression-to-check-for-prime-numbers/ Source Article
class Fixnum
  def prime?</p>

<pre><code>('1' * self) !~ /^1?$|^(11+?)\1+$/
</code></pre>

<p>  end
end
```</p>

<p>``` python Hello world. http://www.google.com Source Article
class Speaker(object):</p>

<pre><code>def __init__(self, listener="world"):
    self.listener = listener

def speak(self):
    print "Hello, %s!" % self.listener
</code></pre>

<p>```</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Tracking HTTP Referer To Determine True Customer Lifetime Value]]></title>
    <link href="http://www.ezliu.com//blog/tracking-http-referer-to-determine-true-customer-lifetime-value/"/>
    <updated>2012-06-19T00:00:00-05:00</updated>
    <id>http://www.ezliu.com//blog/tracking-http-referer-to-determine-true-customer-lifetime-value</id>
    <content type="html"><![CDATA[<p>I want to be able to know what site referred users to my site.</p>

<p>More specifically, I want to be able to look back in a month, and say "users from Linked In did X over their next 10 visits."</p>

<h2>Doesn't Google Analytics do that?</h2>


<p>Not really. Google Analytics, as far as I know, will tell me where a user came from for a visit, but won't let me tie all the future behavior of the site user to their original referer.</p>

<h2>Why Is That Important?</h2>


<p><a href="http://www.rocketlease.com">Rocket Lease</a> has different types of users. Small landlords, big landlords, property managers, leasing agents. While they interact with the site in similar ways, the strategy for connecting with each class of users differs and (I suspect) the total lifetime value of each customer class will vary.</p>

<p style="text-align: center;"><a href="http://www.rocketlease.com"><img src="http://www.ezliu.com//images/rl2-300x156.png" alt="" width="300" height="156" /></a></p>


<p>For example, I intend to advertise on various landlord and property manager forums. Professional property managers tend to manage more properties than a landlord owns, so they likely have higher lifetime value (LTV) and I might be willing to pay more per property manager conversion.</p>

<p>I need to know how much time/effort/money to allocate to advertising on Property Manager Forum X vs reddit/r/smalllandlords.</p>

<p>If there's a real difference in LTV based on user class, measuring global user LTV is a surefire way to inefficiently allocate advertising dollars.</p>

<h2>Just a Little Bit Of Middleware</h2>


<p>I had (still have) a nagging feeling that I was solving a solved problem, but I couldn't find someone else who had done it, so here's what I did.</p>

<pre class="code"><code>
# 2 space indent because my blog is skinny
class OriginalRefererMiddleware(object):
  def process_request(self, request):
    referer = request.META.get("HTTP_REFERER")
    host = request.META.get("HTTP_HOST")
    path_info = request.META.get("PATH_INFO")

    if not "ORIGINAL_HTTP_REFERER" in request.session.keys():
      request.session['ORIGINAL_HTTP_REFERER'] = referer

    if not 'ENTRY_PAGE' in request.session.keys():
      request.session['ENTRY_PAGE'] = host + path_info
</code></pre>




<br />


<p>HTTP requests come with a HTTP_REFERER header that me what page the user clicked through from. So if a user ends on my landing page from linked in, if I extract the HTTP_HEADER, it'll say linked in. But then if they go to my FAQ, now the referer is "<strong>rocketlease.com</strong>", then if they sign up from there, the referer will be "<strong>rocketlease.com/faq</strong>".</p>

<p>Instead, the first time (and only the first time) a user lands on any page served by me, I save the value of the referer. Then when the user finally registers, I just dump the original_referer to my database so at any future time I can determine how any user originally arrived at my site.</p>

<p>I'm planning on experimenting with LinkedIn, Facebook, and Bing ads in the next 2 weeks, so hopefully this will help me determine where I should be allocating ad spend. Linked In and Facebook in particular make it possible for me to target certain classes of users. Rocket Lease basically never makes an actual sale on the initial interaction with a user, so using the ad services' built in analytics isn't sufficient to determine value of a customer class.</p>
]]></content>
  </entry>
  
</feed>
